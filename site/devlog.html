<!DOCTYPE html><html><head><meta charset="utf-8"/><link href="../links/main.css" type="text/css" rel="stylesheet"/><link href="../media/services/icon.png" type="image/png" rel="shortcut icon"/><title>XXIIVV &mdash; devlog</title></head><body><header><a href="home.html"><img alt="XXIIVV" src="../media/icon/logo.svg"/></a></header><nav><ul><li><a href="identity.html">identity</a></li><li><a href="journal.html" class="parent">journal</a></li><li><a href="index.html">index</a></li><li><a href="faqs.html">faqs</a></li></ul><ul><li><a href="calendar.html">calendar</a></li><li><a href="devlog.html" class="self">devlog</a></li><li><a href="now.html">now</a></li></ul><ul><li><a href="uxn_devlog.html">uxn devlog</a></li><li><a href="varvara_devlog.html">varvara devlog</a></li></ul></nav><main><h2>The devlog is a collection of design notes.</h2>

<p>Below are disjointed thoughts on the creation of a <a href='varvara.html'>clean-slate computing stack</a> based on the <a href='uxn.html'>universal virtual machine</a> strategy for digital preservation. As opposed to the seemingly natural trend in software, Uxn is reaching backward in time and making itself available further and further back in time, growing increasingly smaller.</p>

<ul>
	<li><b>Part 1</b>: <a href='uxn_devlog.html'>A virtual machine</a></li>
	<li><b>Part 2</b>: <a href='varvara_devlog.html'>A personal computer</a></li>
	<li><b>Part 3</b>: An operating system</li>
</ul>


<h3>Acknowledgments</h3>

<img src='../media/generic/uxn.apu.jpg' width='240' style='float:right'/>

<p>The realization of this project is largely due to the work of the community, with special thanks to Andy Alderwick, Sigrid Solveig Haflínudóttir, Andrew Richards, and everyone else who contributed ideas and shared their knowledge with me, without whom Uxn could not have become what it is now. Nearly a year after its initial draft, <a href='https://github.com/hundredrabbits/awesome-uxn' target='_blank'>a lot of uxn code</a> has been written. In fact, this text has been written in <a href='left.html'>Left</a>, a text-editor hosted on this strangely personal computer, and this <a href='about.html'>wiki</a> was also built by it.</p>
<h2>A virtual machine</h2>

<p>Before we begin,</p>

<p>Emulation is the reproduction of the behavior of a computer's physical circuitry with software. Given that an emulator can translate the actions of one computer onto an other, the same program could be used on both. This is emulation.</p>

<p>Someone could devise the actions of a fictional computer that is not necessarily based on existing hardware, write software for this fantastical computer, implement an emulators for it, and use the same program on any supported computer. This is a <a href='virtual_machines.html'>virtual machine</a>.</p>

<img src='../media/refs/magiciens.png' alt='Le Matin des magiciens, by Louis Pauwels and Jacques Bergier. 1963' width='200'/>

<p>Over the years, I wrote software for various frameworks and peripherals. Most have died with their respective platform, the rest have fallen behind their ever-changing toolchain. <a href='stack.html'>Bitrot</a> is the inability to access digital data because hardware and software no longer exist to read its format. Perhaps it's a matter of time until people build emulators to make these projects usable again, otherwise these projects were never truly mine, and my learning of these languages <i>only ever belonged to the platforms</i>.</p>

<p><i>So, why not <a href='ansi_c.html'>C</a>? While terminal utilities can be made portable, cross-platform graphical development is not.</i></p>

<h3>I. As Few Bits As Possible</h3>

<p>During my research into portability, I kept thinking about how pleasant it was to play <a href='famicom.html'>NES</a> games today. Pulling on that thread led me to projects designed explicitly for virtual machines, such as <a href='https://fabiensanglard.net/another_world_polygons/' target='_blank'>Another World</a> which is equally easy to play today due to its targeting of a portable virtual machine, instead of any ever-changing physical hardware.</p>

<img src='../media/refs/mos6502.jpg' width="100" style='float:right'/>

<p>For a time, I thought I ought to be building software for the NES to ensure their survival over the influx of disposable <a href='technology.html'>modern platforms</a> &mdash; So, <a href='assembly.html'>I did</a>. Sadly, most of the software that I care to write and use require slightly more than an 8-button controller.</p>

<img src='../media/refs/hands.png' alt='Saul Steinberg, Untouched by Human Hands' width='350'/>

<h3>II. Tarpits & Houses Of Cards</h3>

<p>If the focus of this experiment is to ensure the <a href='http://collapseos.org/why.html'>support</a> of a piece of code by writing emulation software for each new platform, the specs should be painless to implement. Let's use the time one would need to write a passable emulator as a limit in complexity for this system. Could a computer science student implement a mediocre emulation of the 6502 instructions in an afternoon? Could that design be simplified, changed in some way to make it more approachable for would-be implementers?</p>

<img src='../media/refs/bthennota.png' width='100'/>

<p><a href='subleq.html'>Subleq</a> is a <i>One-Instruction</i> architecture, an emulator for this platform takes at most 15 minutes to write. Perhaps this could be an interesting target, but what it does away in emulation complexity, it offloads onto the toolchain needed to make intelligible programs.</p>

<p>Okay, let us <i>also</i> set a limit to the complexity of the toolchain as to not find ourselves in a <a href='https://esolangs.org/wiki/Turing_tarpit' target='_blank'>tarpit</a>. How complex can an assembler be if the maximum amount of time one could use to write it is a single afternoon. It would be an equally Herculean task to build an <b>emulator and assembler</b> for a machine with thousands of instructions; or a single instruction subleq that builds abstract logic from thousands of primitive parts.</p>

<h3>III. Things Betwixt</h3>

<p>A <a href='paper_computer.html'>paper computer</a> was created in the early 1980s, when computer access was not yet widespread, it consists of a piece of paper with 21 lines of code on the left and eight registers on the right. The instruction set of five commands(inc, dec, jmp, isz, stp) is small but <a href='https://en.wikipedia.org/wiki/Turing_completeness' target='_blank'>Turing complete</a>, meaning that it can approximately simulate the computational aspects of any other real-world general-purpose computer, and is therefore enough to represent all mathematical functions.</p>

<img src="../media/refs/computers.png" width="300">

<p>In 1977, a programmer wrote a small virtual machine with <a href='chip8.html'>36 instructions</a>, 16 registers and 4096 bytes of memory. It has no mouse, the screen is barely capable of displaying readable text, its controller is a nightmare. &mdash; But I was able to write an emulator and an assembler for it, in an afternoon.</p>

<p>There is a type of electronics relevant to emulation that <a href='https://excamera.com/sphinx/fpga-j1.html'>has no chips</a>, no instruction set, but instead the programmer designs the hardware circuit in software. As much fun as it would be to create a design that maps well onto these machines, it would make for a poor emulation on my existing devices as it would use nearly none of the optimizations available on the host computer. </p>

<p>Somewhere along this voyage into finding a suitable host for my programs, I began thinking about <a href='collapse.html'>electronic waste</a>, and I couldn't justify surrounding myself with <a href='salvage_computing.html'>yet more electronics</a>. This dream platform would therefore be designed to be emulated, its complexity would be designed around the complexity of software and not that of hardware.</p>

<h3>IV. Back & Forth</h3>

<p>The balancing act of virtual machine instructions, assembler, emulator and the resulting capabilities of its language revealed the stack machines as ideal systems. </p>

<p><a href='forth.html'>Forth</a> is a programming language that consists simply of splitting text into a list of words, breaking on whitespace, and to interpret each word, words are often combinations of other words combined to create more complex words.</p>

<img src="../media/refs/swap.png" alt="Swap operation by Leo Brodie">

<p>Brackets and parentheses are unnecessary: the program merely performs calculations in the order that is required, letting the automatic stack store intermediate results on the fly for later use. Likewise, there is no requirement for precedence rules.</p>

<p>In Forth, memory is made of cells, which are typically <a href='binary.html'>16-bits in length</a>, meaning that each piece of data is a number from 0 to 65535. For this specific imaginary system, I wanted the memory to consist of cells of 8-bit, or numbers from 0 to 255. For example, the <code>12 / (34 - 12)</code> sequence is equivalent to the 6 bytes:</p>

<pre>
uxn    |    #12 #34 OVR SUB DIV
binary | a0  12  34  06  19  1b 
</pre>

<p>Using stack-machine operations as primitives, along with a handful of arithmetic and bitwise helpers, we approach a comfortable 32 opcodes, leaving 3 bits in a byte for little extras, or the following virtual machine:</p>

<table class="tight">
	<tr><th>LIT</th><td>a b c m[pc+1]</td><th>EQU</th><td>a (b?c)</td><th>LDZ</th><td>a b m[c8]</td><th>ADD</th><td>a b+c</td></tr>
	<tr><th>INC</th><td>a b c+1</td><th>NEQ</th><td>a (b!c)</td><th>STZ</th><td>a {m[c8]=b}</td><th>SUB</th><td>a b-c</td></tr>
	<tr><th>POP</th><td>a b</td><th>GTH</th><td>a (b&gt;c)</td><th>LDR</th><td>a b m[pc+c8]</td><th>MUL</th><td>a b*c</td></tr>
	<tr><th>DUP</th><td>a b c c</td><th>LTH</th><td>a (b&lt;c)</td><th>STR</th><td>a {m[pc+c8]=b}</td><th>DIV</th><td>a b/c</td></tr>
	<tr><th>NIP</th><td>a c</td><th>JMP</th><td>a b {pc+=c}</td><th>LDA</th><td>a b m[c16]</td><th>AND</th><td>a b&c</td></tr>
	<tr><th>SWP</th><td>a c b</td><th>JCN</th><td>a {(b8)pc+=c}</td><th>STA</th><td>a {m[c16]=b}</td><th>ORA</th><td>a b|c</td></tr>
	<tr><th>OVR</th><td>a b c b</td><th>JSR</th><td>a b {pc->rs pc+=c}</td><th>DEI</th><td>a b d[c8]</td><th>EOR</th><td>a b^c</td></tr>
	<tr><th>ROT</th><td>b c a</td><th>STH</th><td>a b {c->rs}</td><th>DEO</th><td>a {d[c8]=b}</td><th>SFT</th><td>a b&gt;&gt;c8l&lt;&lt;c8h</td></tr>
</table>

<style>
	table.tight { font-size:smaller; font-family: monospace;width:700px }
	table.tight tr th, table.tight tr td { padding:0px 15px 0px 0px }
</style> <h2>A personal computer</h2>

<p>What are computers for, anyway?</p>

<p>Some mathematicians are of the opinion that the doing of mathematics is closer to discovery than invention. I think of computers like a sort of telescope, but to observe immaterial objects. Mathematical beauty is the aesthetic pleasure derived from the abstractness, or orderliness of mathematics. Similarly to how one might enjoy spending time studying venation patterns, we can imagine a device to explore procedural music and parametric illustration.</p>

<img src='../media/refs/de_pictura.png' alt='De Pictura, Leon Battista Alberti. 1963' width='400'/>

<p>This romantic vision of the <a href='anarchy.html'>luddite</a>, potentially emancipating, power of computing was promptly smothered by military drones, surveillance hardware and the advertisement machinery. Suffice to say, that nowadays, to most of my friends, computing evokes either encroaching social networks or the drudgery of data entry.</p>

<img src='../media/refs/hello.png' alt='Hello, on Macintosh.' width='100'/>

<p>Perhaps I'm making it more difficult than necessary by using the term <i>personal computer</i>, and not finding a more apt word to describe what I have in mind. This devlog is a summary of notes on the creation of a personal computer built upon the virtual machine documented in the <a href='uxn_devlog.html'>previous post</a>.</p>

<h3>I. Personal</h3>

<p>We must consider the whole enterprise of designing and documenting Varvara to be a sort of <i>model</i> that others could adapt to their own <a href='marvelous_pursuit.html'>designs</a>, a manifesto calling on individuals to conjure up their own vision of a computing machine, tailored to suit their own needs. The purpose of this document is not to gather would-be users of this specific system, but instead remind each other that the key to permaculture is to create resilience through a diversification of methods.</p>

<img src='../media/refs/house.png' width='400'/>

<p>I am certain that making something unique by way of customization is necessary for care, <i>for when the unique breaks, </i><a href='https://simonsarris.substack.com/p/that-which-is-unique-breaks' target='_blank'>we might mend</a>. I often think back on how, in the movie Hackers(1995), each character had their own laptop launch sequence reflecting parts of their aesthetics. &mdash; A far cry from today's <a href='commodity.html'>disposable laptops</a>, each equally adorned of <i>proprietary services</i> stickers.</p>

<p>For mending to even be envisaged, one must be able to generally understand that which needs to be mended; a venture which, thanks to the ever complexifying stack upon which modern computing is built, will have you promptly laughed out of the room. But just for the sake of our talking about virtual machines, our required understanding of the system shall end at its bytecode.</p>

<p>A side-effect of working from within unique computing environments is that looking for generic solutions is often more impractical than solving the problem head on. By that, I mean by that the solution needs to be adapted to the specifics of the virtual system, and this in turn develops understanding and care.</p>

<h3>II. Computer</h3>

<p>Varvara is a definition of potential I/O communications with the Uxn virtual machine. The VM can communicate with up to 16 devices at once, but has no knowledge of what a screen or a keyboard might be, these devices are what make up the Varvara computer.</p>

<q>Uxn is to Varvara, what the 6502 is to the Classic Nintendo.</q>

<p>When it came time to find out how I might want to interact with this computer, I started with a terminal, it seemed as good a place as any to start off from. The terminal communication allowed me to leverage the power of my current host OS to further develop the system. </p>

<img src='../media/generic/uxn.devices.png' width='350'/>

<p>As the system began to take shape, I considered that possibly someday I may loose my sight, or the use of my hands, or I may become deaf. As I assembled the various parts of the system, I wondered how I might replace one device for another in the future, and how I might adapt each device to my changing needs. I left some blank spaces to be filled at a later time, should I need them.</p>

<h3>III. The Screen as Example</h3>

<p>I heard tales from the fabled era of computing when people would create simple operating systems over the course of a weekend or two, it inspired me to try and find the building blocks needed to make this process more approachable. I decided to use the screen to demonstrate some of the ideas explored in Varvara, but I could have as easily picked another device for they are all designed similarly.</p>

<p>We'll begin with drawing a <b>pixel</b>, from which lines, letters, shapes and other primitives can be derived.</p>

<pre>
@draw-pixel ( -- )
	#0010 .Screen/x DEO2   <span style='float:right; color:#777'>a000 1080 2837</span>
	#0020 .Screen/y DEO2   <span style='float:right; color:#777'>a000 2080 2a37</span>
	#01 .Screen/pixel DEO  <span style='float:right; color:#777'>a001 2e17</span>
JMP2r
</pre>

<img src='../media/generic/pixel.heart.png' width='200' style='float:right'/>

<p>One of the many things that <a href='plan9.html'>Plan 9</a> has made quite clear to me, was that interface design can be fun. An easy access to a pixel buffer makes all the difference for fostering an ecosystem of personalized applications. </p>

<p>The Famicom's picture processing unit uses little 8x8 tiles, which fit neatly in 8 bytes of memory, where each byte is a row, and each monochromatic pixel is a bit. This tile size is small enough that someone with a pen and paper could mentally decipher its content, and large enough to contain a letter or a pictogram.</p>

<pre>
@draw-heart ( -- )
	#0010 .Screen/x DEO2   <span style='float:right; color:#777'>a000 1080 2837</span>
	#0020 .Screen/y DEO2   <span style='float:right; color:#777'>a000 2080 2a37</span>
	;heart-icn .Screen/addr DEO2 <span style='float:right; color:#777'>a001 2e80 2c37</span>
	#01 .Screen/sprite DEO  <span style='float:right; color:#777'>a001 2e17</span>
JMP2r

@heart-icn
	006c fefe 7c38 1000
</pre>

<img src='../media/generic/pixel.smile.png' width='200' style='float:right'/>

<p>The Neo Geo's graphics processor assembles tiles into larger sprites by drawing them in a sequence, either vertically or horizontally.</p>

<p>We can draw a 2x2 picture by sending a single extra drawing instruction for the bottom row of the picture, we can leverage this sprite drawing system to draw larger real-time graphics with very little boilerplate and change in bytecode size.</p>

<pre>
@draw-smile ( -- )
	#0010 .Screen/x DEO2   <span style='float:right; color:#777'>a000 1080 2837</span>
	#0020 .Screen/y DEO2   <span style='float:right; color:#777'>a000 2080 2a37</span>
	;smile-icns .Screen/addr DEO2 <span style='float:right; color:#777'>a001 3780 2c37</span>
	#16 .Screen/auto DEO <span style='float:right; color:#777'>a016 2617</span>
	#01 .Screen/sprite DEOk DEO <span style='float:right; color:#777'>a001 2f97 17</span>
JMP2r

@smile-icns
	( first row )
	0007 1820 2040 4044 00e0 1804 0402 0222
	( second row ) 
	4040 4423 2018 0700 0202 22c4 0418 e000
</pre>
<ul></ul></main>
<footer><a href="https://creativecommons.org/licenses/by-nc-sa/4.0" target="_blank"><img src="../media/icon/cc.svg" alt="CreativeCommons"/></a><a href="https://webring.xxiivv.com/" target="_blank"><img src="../media/icon/webring.svg" alt="Webring"/></a><a href="https://merveilles.town/@neauoire" rel="me" target="_blank"><img src="../media/icon/merveilles.svg" alt="Merveilles"/></a><a href="uxn.html"><img src="../media/icon/uxn.svg" alt="Uxn Powered"/></a><span><a href="devine_lu_linvega.html">Devine Lu Linvega</a> &copy; 2022 &mdash; <a href="about.html">BY-NC-SA 4.0</a></span></footer></body></html>