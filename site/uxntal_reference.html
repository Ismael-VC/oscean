<!DOCTYPE html><html><head><meta charset="utf-8"/><link href="../links/main.css" type="text/css" rel="stylesheet"/><link href="../media/services/icon.png" type="image/png" rel="shortcut icon"/><title>XXIIVV &mdash; uxntal reference</title></head><body><header><a href="home.html"><img src="../media/icon/logo.svg" alt="XXIIVV"/></a></header><nav><ul><li><a href="uxntal.html" class="parent">uxntal</a></li><li><a href="varvara.html">varvara</a></li></ul><ul><li><a href="uxntal_cheatsheet.html">uxntal cheatsheet</a></li><li><a href="uxntal_reference.html" class="self">uxntal reference</a></li><li><a href="uxntal_macros.html">uxntal macros</a></li></ul><ul></ul></nav><main><h2>The Uxntal Opcode Manual</h2>

<p>The LIT and BRK opcodes share the same opcode space, the BRK opcode is stored as <code>00</code>, whereas the LIT and LIT2 opcodes are stored where LITk and LIT2k would be stored. The extra modes of the BRK/LIT opcode are unused.</p>
<table border='1' style='font-size: small;font-family: mono,monospace;'>
	<tr><th></th><th>00</th><th>01</th><th>02</th><th>03</th><th>04</th><th>05</th><th>06</th><th>07</th><th>08</th><th>09</th><th>0a</th><th>0b</th><th>0c</th><th>0d</th><th>0e</th><th>0f</th></tr>
	<tr style='background:#eee'><th>00</th><td style='background:#72dec2'>BRK</td><td>INC</td><td>POP</td><td>DUP</td><td>NIP</td><td>SWP</td><td>OVR</td><td>ROT</td><td>EQU</td><td>NEQ</td><td>GTH</td><td>LTH</td><td>JMP</td><td>JCN</td><td>JSR</td><td>STH</td></tr>
	<tr style='background:#eee'><th>10</th><td>LDZ</td><td>STZ</td><td>LDR</td><td>STR</td><td>LDA</td><td>STA</td><td>DEI</td><td>DEO</td><td>ADD</td><td>SUB</td><td>MUL</td><td>DIV</td><td>AND</td><td>ORA</td><td>EOR</td><td>SFT</td></tr>
	<tr style='background:#eee'><th>20</th><td>---</td><td>INC2</td><td>POP2</td><td>DUP2</td><td>NIP2</td><td>SWP2</td><td>OVR2</td><td>ROT2</td><td>EQU2</td><td>NEQ2</td><td>GTH2</td><td>LTH2</td><td>JMP2</td><td>JCN2</td><td>JSR2</td><td>STH2</td></tr>
	<tr style='background:#eee'><th>30</th><td>LDZ2</td><td>STZ2</td><td>LDR2</td><td>STR2</td><td>LDA2</td><td>STA2</td><td>DEI2</td><td>DEO2</td><td>ADD2</td><td>SUB2</td><td>MUL2</td><td>DIV2</td><td>AND2</td><td>ORA2</td><td>EOR2</td><td>SFT2</td></tr>
	<tr><th>40</th><td>---</td><td>INCr</td><td>POPr</td><td>DUPr</td><td>NIPr</td><td>SWPr</td><td>OVRr</td><td>ROTr</td><td>EQUr</td><td>NEQr</td><td>GTHr</td><td>LTHr</td><td>JMPr</td><td>JCNr</td><td>JSRr</td><td>STHr</td></tr>
	<tr><th>50</th><td>LDZr</td><td>STZr</td><td>LDRr</td><td>STRr</td><td>LDAr</td><td>STAr</td><td>DEIr</td><td>DEOr</td><td>ADDr</td><td>SUBr</td><td>MULr</td><td>DIVr</td><td>ANDr</td><td>ORAr</td><td>EORr</td><td>SFTr</td></tr>
	<tr><th>60</th><td>---</td><td>INC2r</td><td>POP2r</td><td>DUP2r</td><td>NIP2r</td><td>SWP2r</td><td>OVR2r</td><td>ROT2r</td><td>EQU2r</td><td>NEQ2r</td><td>GTH2r</td><td>LTH2r</td><td>JMP2r</td><td>JCN2r</td><td>JSR2r</td><td>STH2r</td></tr>
	<tr><th>70</th><td>LDZ2r</td><td>STZ2r</td><td>LDR2r</td><td>STR2r</td><td>LDA2r</td><td>STA2r</td><td>DEI2r</td><td>DEO2r</td><td>ADD2r</td><td>SUB2r</td><td>MUL2r</td><td>DIV2r</td><td>AND2r</td><td>ORA2r</td><td>EOR2r</td><td>SFT2r</td></tr>
	<tr style='background:#eee'><th>80</th><td style='background:#000;color:#fff'>LIT</td><td>INCk</td><td>POPk</td><td>DUPk</td><td>NIPk</td><td>SWPk</td><td>OVRk</td><td>ROTk</td><td>EQUk</td><td>NEQk</td><td>GTHk</td><td>LTHk</td><td>JMPk</td><td>JCNk</td><td>JSRk</td><td>STHk</td></tr>
	<tr style='background:#eee'><th>90</th><td>LDZk</td><td>STZk</td><td>LDRk</td><td>STRk</td><td>LDAk</td><td>STAk</td><td>DEIk</td><td>DEOk</td><td>ADDk</td><td>SUBk</td><td>MULk</td><td>DIVk</td><td>ANDk</td><td>ORAk</td><td>EORk</td><td>SFTk</td></tr>
	<tr style='background:#eee'><th>a0</th><td style='background:#000;color:#fff'>LIT2</td><td>INC2k</td><td>POP2k</td><td>DUP2k</td><td>NIP2k</td><td>SWP2k</td><td>OVR2k</td><td>ROT2k</td><td>EQU2k</td><td>NEQ2k</td><td>GTH2k</td><td>LTH2k</td><td>JMP2k</td><td>JCN2k</td><td>JSR2k</td><td>STH2k</td></tr>
	<tr style='background:#eee'><th>b0</th><td>LDZ2k</td><td>STZ2k</td><td>LDR2k</td><td>STR2k</td><td>LDA2k</td><td>STA2k</td><td>DEI2k</td><td>DEO2k</td><td>ADD2k</td><td>SUB2k</td><td>MUL2k</td><td>DIV2k</td><td>AND2k</td><td>ORA2k</td><td>EOR2k</td><td>SFT2k</td></tr>
	<tr><th>c0</th><td style='background:#000;color:#fff'>LITr</td><td>INCrk</td><td>POPrk</td><td>DUPrk</td><td>NIPrk</td><td>SWPrk</td><td>OVRrk</td><td>ROTrk</td><td>EQUrk</td><td>NEQrk</td><td>GTHrk</td><td>LTHrk</td><td>JMPrk</td><td>JCNrk</td><td>JSRrk</td><td>STHrk</td></tr>
	<tr><th>d0</th><td>LDZrk</td><td>STZrk</td><td>LDRrk</td><td>STRrk</td><td>LDArk</td><td>STArk</td><td>DEIrk</td><td>DEOrk</td><td>ADDrk</td><td>SUBrk</td><td>MULrk</td><td>DIVrk</td><td>ANDrk</td><td>ORArk</td><td>EORrk</td><td>SFTrk</td></tr>
	<tr><th>e0</th><td style='background:#000;color:#fff'>LIT2r</td><td>INC2rk</td><td>POP2rk</td><td>DUP2rk</td><td>NIP2rk</td><td>SWP2rk</td><td>OVR2rk</td><td>ROT2rk</td><td>EQU2rk</td><td>NEQ2rk</td><td>GTH2rk</td><td>LTH2rk</td><td>JMP2rk</td><td>JCN2rk</td><td>JSR2rk</td><td>STH2rk</td></tr>
	<tr><th>f0</th><td>LDZ2rk</td><td>STZ2rk</td><td>LDR2rk</td><td>STR2rk</td><td>LDA2rk</td><td>STA2rk</td><td>DEI2rk</td><td>DEO2rk</td><td>ADD2rk</td><td>SUB2rk</td><td>MUL2rk</td><td>DIV2rk</td><td>AND2rk</td><td>ORA2rk</td><td>EOR2rk</td><td>SFT2rk</td></tr>
</table>

<h3>Instructions</h3>
<ul>
  <li><code>a -- b</code>: Instruction consumes <code>a</code> as input off the stack, and pushes the result <code>b</code> onto the stack.</li>
	<li><code>arg</code>: An 8-bit or 16-bit value, depending upon whether Short Mode is set.</li>
	<li><code>arg^</code>: An 8-bit value regardless of whether Short Mode is set. </li>
	<li><code>arg*</code>: An 16-bit value regardless of whether Short Mode is set. </li>
	<li><code>bool</code>: The byte 00 for false, or the byte 01 for true.</li>
</ul>

<h4 id='brk'>Break</h4>
<p>
<code class='op'>BRK</code>
<code class="sig">--</code>
Halts the program. Further instructions will not be run.</p>

<h4 id='lit'>Literal</h4>
<p>
<code class='op'>LIT</code>
<code class="sig">-- a</code>
Pushes the next value seen in the program onto the stack.</p>

<h4 id='inc'>Increment</h4>
<p>
<code class='op'>INC</code>
<code class="sig">a -- b</code>
Adds 1 to the value at the top of the stack.</p>
<pre>
#01 INC         ( 02 )
#0001 INC2      ( 00 02 )
#0001 INC2k     ( 00 01 00 02 )
</pre>

<h4 id='pop'>Pop</h4>
<p>
<code class='op'>POP</code>
<code class="sig">a --</code>
Removes the value at the top of the stack.</p>
<pre>
#1234 POP    ( 12 )
#1234 POP2   ( )
#1234 POP2k  ( 12 34 )
</pre>

<h4 id='dup'>Duplicate</h4>
<p>
<code class='op'>DUP</code>
<code class="sig">a -- a</code>
Duplicates the value at the top of the stack.</p>
<pre>
#1234 DUP   ( 12 34 34 )
#1234 DUP2  ( 12 34 12 34 )
</pre>

<h4 id='nip'>Nip</h4>
<p>
<code class='op'>NIP</code>
<code class="sig">a b -- b</code>
Removes the second value from the stack.</p>
<pre>
#1234 NIP          ( 34 )
#1234 #5678 NIP2   ( 56 78 )
#1234 #5678 NIP2k  ( 12 34 56 78 56 78 )
</pre>

<h4 id='swp'>Swap</h4>
<p>
<code class='op'>SWP</code>
<code class="sig">a b -- b a</code>
Exchanges the first and second values at the top of the stack.</p>
<pre>
#1234 SWP          ( 34 12 )
#1234 SWPk         ( 12 34 34 12 )
#1234 #5678 SWP2   ( 56 78 12 34 )
#1234 #5678 SWP2k  ( 12 34 56 78 56 78 12 34 )
</pre>

<h4 id='ovr'>Over</h4>
<p>
<code class='op'>OVR</code>
<code class="sig">a b -- a b a</code>
Duplicates the second value at the top of the stack.</p>
<pre>
#1234 OVR          ( 12 34 12 )
#1234 OVRk         ( 12 34 12 34 12 )
#1234 #5678 OVR2   ( 12 34 56 78 12 34 )
#1234 #5678 OVR2k  ( 12 34 56 78 12 34 56 78 12 34 )
</pre>

<h4 id='rot'>Rotate</h4>
<p>
<code class='op'>ROT</code>
<code class="sig">a b c -- b c a</code>
Rotates three values at the top of the stack, to the left, wrapping around.</p>
<pre>
#1234 #56 ROT            ( 34 56 12 )
#1234 #56 ROTk           ( 12 34 56 34 56 12 )
#1234 #5678 #9abc ROT2   ( 56 78 9a bc 12 34 )
#1234 #5678 #9abc ROT2k  ( 12 34 56 78 9a bc 56 78 9a bc 12 34 )
</pre>

<h3>Logic</h3>

<h4 id='equ'>Equal</h4>
<p>
<code class='op'>EQU</code>
<code class="sig">a b -- bool^</code>
Pushes 01 to the stack if the two values at the top of the stack are equal, 00 otherwise.</p>
<pre>
#0101 EQU          ( 01 )
#0100 EQUk         ( 01 00 00 )
#0001 #0000 EQU2   ( 00 )
#0001 #0000 EQU2k  ( 00 01 00 00 00 )
</pre>

<h4 id='neq'>Not Equal</h4>
<p>
<code class='op'>NEQ</code>
<code class="sig">a b -- bool^</code>
Pushes 01 to the stack if the two values at the top of the stack are not equal, 00 otherwise.</p>
<pre>
#0101 NEQ          ( 00 )
#0100 NEQk         ( 01 00 01 )
#0001 #0000 NEQ2   ( 01 )
#0001 #0000 NEQ2k  ( 00 01 00 00 01 )
</pre>

<h4 id='gth'>Greater Than</h4>
<p>
<code class='op'>GTH</code>
<code class="sig">a b -- bool^</code>
Pushes 01 to the stack if the second value at the top of the stack is greater than the value at the top of the stack, 00 otherwise.</p>
<pre>
#0101 GTH          ( 00 )
#0100 GTHk         ( 01 00 01 )
#0001 #0000 GTH2   ( 01 )
#0001 #0000 GTH2k  ( 00 01 00 00 01 )
</pre>

<h4 id='lth'>Lesser Than</h4>
<p>
<code class='op'>LTH</code>
<code class="sig">a b -- bool^</code>
Pushes 01 to the stack if the second value at the top of the stack is lesser than the value at the top of the stack, 00 otherwise.</p>
<pre>
#0101 LTH          ( 00 )
#0100 LTHk         ( 01 00 00 )
#0001 #0000 LTH2   ( 00 )
#0001 #0000 LTH2k  ( 00 01 00 00 00 )
</pre>

<h3>Control-Flow</h3>

<h4 id='jmp'>Jump</h4>
<p>
<code class='op'>JMP</code>
<code class="sig">addr --</code>
Moves the program counter by a signed value equal to the byte on the top of the stack, or an absolute address in short mode.</p>

<h4 id='jcn'>Jump Conditional</h4>
<p>
<code class='op'>JCN</code>
<code class="sig">bool^ addr --</code>
If the byte preceeding the address is not 00, moves the program counter by a signed value equal to the byte on the top of the stack, or an absolute address in short mode.</p>

<h4 id='jsr'>Jump Stash Return</h4>
<p>
<code class='op'>JSR</code>
<code class="sig">addr --</code>
Pushes the value of the program counter to the return-stack and moves the program counter by a signed value equal to the byte on the top of the stack, or an absolute address in short mode.</p>

<h4 id='sth'>Stash</h4>
<p>
<code class='op'>STH</code>
<code class="sig">a --</code>
Moves the value at the top of the stack, to the return stack.</p>

<h3>Memory</h3>

<h4 id='ldz'>Load Zero-Page</h4>
<p>
<code class='op'>LDZ</code>
<code class="sig">addr^ -- value</code>
Pushes the value at an address within the first 256 bytes of memory, to the top of the stack.</p>

<h4 id='stz'>Store Zero-Page</h4>
<p>
<code class='op'>STZ</code>
<code class="sig">val addr^ --</code>
Writes a value to an address within the first 256 bytes of memory.</p>

<h4 id='ldr'>Load Relative</h4>
<p>
<code class='op'>LDR</code>
<code class="sig">addr^ -- value</code>
Pushes the value at a relative address, to the top of the stack. The possible relative range is -128 to +127 bytes.</p>

<h4 id='str'>Store Relative</h4>
<p>
<code class='op'>STR</code>
<code class="sig">val addr^ --</code>
Writes a value to a relative address. The possible relative range is -128 to +127 bytes.</p>

<h4 id='lda'>Load Absolute</h4>
<p>
<code class='op'>LDA</code>
<code class="sig">addr* -- value</code>
Pushes the value at a absolute address, to the top of the stack.</p>

<h4 id='sta'>Store Absolute</h4>
<p>
<code class='op'>STA</code>
<code class="sig">val addr* --</code>
Writes a value to a absolute address.</p>

<h3>Arithmetic</h3>

<h4 id='add'>Add</h4>
<p>
<code class='op'>ADD</code>
<code class="sig">a b -- c</code>
Pushes the sum of the two values at the top of the stack.</p>

<h4 id='sub'>Subtract</h4>
<p>
<code class='op'>SUB</code>
<code class="sig">a b -- c</code>
Pushes the difference of the first value minus the second, to the top of the stack.</p>

<h4 id='mul'>Multiply</h4>
<p>
<code class='op'>MUL</code>
<code class="sig">a b -- c</code>
Pushes the product of the first and second values at the top of the stack.</p>

<h4 id='div'>Divide</h4>
<p>
<code class='op'>DIV</code>
<code class="sig">a b -- c</code>
Pushes the quotient of the first value over the second, to the top of the stack.</p>

<h3>Bitwise</h3>

<h4 id='and'>And</h4>
<p>
<code class='op'>AND</code>
<code class="sig">a b -- c</code>
Pushes the result of the bitwise operation AND, to the top of the stack.</p>

<h4 id='ora'>Or</h4>
<p>
<code class='op'>ORA</code>
<code class="sig">a b -- c</code>
Pushes the result of the bitwise operation OR, to the top of the stack.</p>

<h4 id='eor'>Exclusive Or</h4>
<p>
<code class='op'>EOR</code>
<code class="sig">a b -- c</code>
Pushes the result of the bitwise operation XOR, to the top of the stack.</p>

<h4 id='sft'>Shift</h4>
<p>
<code class='op'>SFT</code>
<code class="sig">a b^ -- c</code>
Moves the bits of the value at the top of the stack to the left or right, depending on the control value of the second. The high nibble of the control value determines how many bits left to shift, and the low nibble how many bits right to shift. The rightward shift is done first.</p>

<style>
.clr0 { background:white; color:black; }
.clr1 { background:black; color:white; }
.clr2 { background:#72dec2; color:black; }
.clr3 { background:#ff0000; color:black; }
code.sig { background: #72dec2; color: black; font-size: smaller; display: inline-block; padding: 0px 6px; font-weight: bold; border-radius: 2px; line-height: 22px }
code.op { background: #000; color: white; font-size: smaller; display: inline-block; padding: 0px 6px; font-weight: bold; border-radius: 2px; line-height: 22px }
pre span.comment { color:#666; }
</style>

<ul>
	<li><a href='http://kira.solar' target='_blank'>Kira Oakley</a>, contributor</li>
	<li><a href='https://github.com/Ismael-VC' target='_blank'>Ismael Venegas Castello</a>, contributor</li>
</ul>
<ul></ul></main><footer><a href="https://creativecommons.org/licenses/by-nc-sa/4.0" target="_blank"><img src="../media/icon/cc.svg" alt="CreativeCommons"/></a><a href="https://webring.xxiivv.com/" target="_blank"><img src="../media/icon/webring.svg" alt="Webring"/></a><a href="https://merveilles.town/@neauoire" target="_blank"><img src="../media/icon/merveilles.svg" alt="Merveilles"/></a><a href="uxn.html"><img src="../media/icon/uxn.svg" alt="Uxn Powered"/></a><span><a href="devine_lu_linvega.html">Devine Lu Linvega</a> &copy; 2021 &mdash; <a href="about.html">BY-NC-SA 4.0</a></span></footer>
</body></html>