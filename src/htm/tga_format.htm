<h2>Truevision TGA is a raster graphics file format created by Truevision.</h2>

<p>TGA are the current image transfer format between <a href="varvara.html">Varvara</a> and the host operating system.</p>

<table border="1">
	<tr><th>Length</th><th>Field name</th><th>Description</th></tr>
	<tr><td>1 byte</td><td>ID length</td><td>Length of the image ID field</td></tr>
	<tr><td>1 byte</td><td>Color map type</td><td>Whether a color map is included</td></tr>
	<tr><td>1 byte</td><td>Image type</td><td>Compression and color types</td></tr>
	<tr><td>5 bytes</td><td>Color map specification</td><td>Describes the color map</td></tr>
	<tr><th colspan="3">Specification</th></tr>
	<tr><td>2 bytes</td><td>X-origin</td><td>absolute x of lower-left corner</td></tr>
	<tr><td>2 bytes</td><td>Y-origin</td><td>absolute y of lower-left corner</td></tr>
	<tr><td>2 bytes</td><td>Image width</td><td>width in pixels</td></tr>
	<tr><td>2 bytes</td><td>Image height</td><td>height in pixels</td></tr>
	<tr><td>1 byte</td><td>Pixel depth</td><td>bits per pixel</td></tr>
	<tr><td>1 byte</td><td>Image descriptor</td><td>bits 3-0 give the alpha channel depth, bits 5-4 give direction</td></tr>
</table>

<h3>Image ID length</h3>

<p>0–255 The number of bytes that the image ID field consists of. The image ID field can contain any information, but it is common for it to contain the date and time the image was created or a serial number.</p>

<h3>Color map type</h3>

<ul>
	<li>0 if image file contains no color map</li>
	<li>1 if present</li>
	<li>2–127 reserved by Truevision</li>
	<li>128–255 available for developer use</li>
</ul>

<h3>Image type</h3>

<p>Enumerated in the lower three bits, with the fourth bit as a flag for RLE.  Some possible values are:</p>

<ul>
	<li>0  no image data is present</li>
	<li>1  uncompressed color-mapped image</li>
	<li>2  uncompressed true-color image</li>
	<li>3  uncompressed black-and-white (grayscale) image</li>
	<li>9  run-length encoded color-mapped image</li>
	<li>10 run-length encoded true-color image</li>
	<li>11 run-length encoded black-and-white (grayscale) image</li>
</ul>

<p>Image type 1 and 9: Depending on the Pixel Depth value, image data representation is an 8, 15, or 16 bit index into a color map that defines the color of the pixel.
Image type 2 and 10: The image data is a direct representation of the pixel color. For a Pixel Depth of 15 and 16 bit, each pixel is stored with 5 bits per color. If the pixel depth is 16 bits, the topmost bit is reserved for transparency. For a pixel depth of 24 bits, each pixel is stored with 8 bits per color. A 32-bit pixel depth defines an additional 8-bit alpha channel. Image type 3 and 11: The image data is a direct representation of grayscale data. The pixel depth is 8 bits for images of this type.</p>

<h3>Color map specification</h3>

<ul>
	<li>First entry index (2 bytes): index of first color map entry that is included in the file</li>
	<li>Color map length (2 bytes): number of entries of the color map that are included in the file</li>
	<li>Color map entry size (1 byte): number of bits per pixel</li>
</ul>

<p>In case that not the entire color map is actually used by the image, a non-zero first entry index allows to store only a required part of the color map in the file.</p>

<ul>
	<li><a href='https://git.sr.ht/~rabbits/tga-format' target='_blank'>view source</a></li>
</ul>

